(function(){"use strict";var t={7304:function(t,e,o){var s=o(5130),n=o(6768),r=o(4232);const i=(0,n.Lk)("p",null,null,-1),a=["textContent"],l=(0,n.Lk)("p",null,null,-1),c={key:0,class:"step-one"},d={key:1};function u(t,e,o,s,u,p){const h=(0,n.g2)("LessonsComponent"),m=(0,n.g2)("CheckoutComponent");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("header",null,[i,(0,n.Lk)("div",{class:"text-center",style:{"font-size":"25px","margin-bottom":"50px"},textContent:(0,r.v_)(u.sitename)},null,8,a)]),(0,n.Lk)("main",null,[l,1===u.step?((0,n.uX)(),(0,n.CE)("div",c,[(0,n.bF)(h,{onAddToCart:p.addToCart,"can-add-to-cart":p.canAddToCart,"cart-item-count":p.cartItemCount,"show-checkout":p.showCheckout,"get-image-url":p.getImageUrl,"is-loading":u.isLoading,"get-lessons":p.getLessons,"search-lessons":p.fetchLessons,"sort-by":u.sort_by,"onUpdate:sortBy":e[0]||(e[0]=t=>u.sort_by=t),"sort-order":u.sort_order,"onUpdate:sortOrder":e[1]||(e[1]=t=>u.sort_order=t)},null,8,["onAddToCart","can-add-to-cart","cart-item-count","show-checkout","get-image-url","is-loading","get-lessons","search-lessons","sort-by","sort-order"])])):(0,n.Q3)("",!0),2===u.step?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(m,{onRemoveItemFromCart:p.removeFromCart,"get-image-url":p.getImageUrl,"is-loading":u.isLoading,cart:u.cart,"show-lessons":p.showLessons,"submit-order":p.submitOrder},null,8,["onRemoveItemFromCart","get-image-url","is-loading","cart","show-lessons","submit-order"])])):(0,n.Q3)("",!0)])],64)}o(4114);const p={class:"step-one"},h={class:"px-4 py-4 justify-content-center"},m={class:""},b={class:"d-flex justify-content-between my-2"},v={style:{"margin-top":"5px"},class:"me-5"},f=(0,n.Lk)("label",{for:"sort_by"},"Sort By:",-1),y=["value"],k=(0,n.Fv)('<option disabled value="">None</option><option value="topic">Subject</option><option value="location">Location</option><option value="price">Price</option><option value="spaces">Spaces</option>',5),g=[k],L={style:{"margin-top":"15px"}},C=(0,n.Lk)("label",{for:"sort_order"},"Sort Order:",-1),x=["value"],_=(0,n.Lk)("option",{disabled:"",value:""},"None",-1),w=(0,n.Lk)("option",{value:"asc"},"Ascending",-1),j=(0,n.Lk)("option",{value:"desc"},"Descending",-1),F=[_,w,j],O={style:{"margin-top":"20px"},class:"mb-4"},E=(0,n.Lk)("label",{for:"search"},"Search:",-1),I=(0,n.Fv)('<div class="d-flex justify-content-between align-items-center border-bottom mt-5 py-2"><div class="col-4">Subject</div><div class="col-2 justify-content-end ml-auto">Location</div><div class="col-2">Price</div><div class="col-2">Spaces</div><div class="col-2"></div></div>',1),q={key:0},S={class:"col-4 d-flex"},X=["alt","src"],$={style:{"margin-left":"20px"}},T={class:"col-2 justify-content-end ml-auto"},A={class:"col-2"},U={class:"col-2"},B={class:"mx-4"},K={class:"col-2 text-center"},P=["disabled","onClick"],W=(0,n.Lk)("span",{class:"fas fa-cart-plus"},null,-1),N={key:1,class:"d-flex mt-5 justify-content-center"},Q=(0,n.Lk)("div",{class:"lds-dual-ring justify-content-center align-items-center"},null,-1),J=[Q],R={class:"d-flex justify-content-center ml-auto mb-3 fixed-bottom"},V=["disabled"],z=(0,n.Lk)("span",{class:"fas fa-shopping-cart"},null,-1);function D(t,e,o,i,a,l){return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",h,[(0,n.Lk)("div",m,[(0,n.Lk)("div",b,[(0,n.Lk)("div",v,[f,(0,n.Lk)("select",{value:o.sortBy,onChange:e[0]||(e[0]=e=>t.$emit("update:sortBy",e.target.value)),id:"sort_by",class:"input ml-2"},g,40,y),(0,n.Lk)("div",L,[C,(0,n.Lk)("select",{value:o.sortOrder,onChange:e[1]||(e[1]=e=>t.$emit("update:sortOrder",e.target.value)),id:"sort_order",class:"input ml-2"},F,40,x)])]),(0,n.Lk)("div",O,[E,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.search=t),onInput:e[3]||(e[3]=t=>o.searchLessons(a.search)),id:"search",type:"search",name:"search",class:"input ml-2"},null,544),[[s.Jo,a.search]])])]),I,o.isLoading?((0,n.uX)(),(0,n.CE)("div",N,J)):((0,n.uX)(),(0,n.CE)("div",q,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.getLessons(),((e,s)=>((0,n.uX)(),(0,n.CE)("div",{style:{display:"inline-block",padding:"30px 0px 30px","border-bottom":"1px solid rgb(235, 227, 227)"},key:s,class:"d-flex justify-content-between"},[(0,n.Lk)("div",S,[(0,n.Lk)("p",null,[(0,n.Lk)("img",{style:{height:"50px",width:"50px"},alt:e.topic,src:o.getImageUrl(e.image)},null,8,X)]),(0,n.Lk)("p",$,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.topic.toString().split(new RegExp(`(?<=${a.search})|(?=${a.search})`,"i")),((t,e)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[t.toLowerCase()===a.search.toLowerCase()?((0,n.uX)(),(0,n.CE)("mark",{key:e,class:"text-warning"},(0,r.v_)(t),1)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,r.v_)(t),1)],64))],64)))),256))])]),(0,n.Lk)("div",T,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.location.toString().split(new RegExp(`(?<=${a.search})|(?=${a.search})`,"i")),((t,e)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[t.toLowerCase()===a.search.toLowerCase()?((0,n.uX)(),(0,n.CE)("mark",{key:e,class:"text-warning"},(0,r.v_)(t),1)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,r.v_)(t),1)],64))],64)))),256))]),(0,n.Lk)("div",A,[(0,n.Lk)("p",null,"$"+(0,r.v_)(e.price),1)]),(0,n.Lk)("div",U,[(0,n.Lk)("p",B,(0,r.v_)(e.spaces),1)]),(0,n.Lk)("div",K,[(0,n.Lk)("button",{type:"button",disabled:!o.canAddToCart(e),onClick:o=>t.$emit("add-to-cart",e),class:"rounded-2 btn btn-info p-3 text-white",style:{"border-radius":"6px",cursor:"pointer"}},[W,(0,n.eW)(" Add to cart ")],8,P)])])))),128))]))]),(0,n.Lk)("div",R,[(0,n.Lk)("button",{type:"button",disabled:o.cartItemCount<1,onClick:e[4]||(e[4]=(...t)=>o.showCheckout&&o.showCheckout(...t)),class:"btn btn-info p-3 rounded-2 text-white",style:{"border-radius":"6px",cursor:"pointer"}},[(0,n.eW)((0,r.v_)(o.cartItemCount)+" ",1),z,(0,n.eW)(" View Cart ")],8,V)])])])}var G={name:"lessons-component",data(){return{search:""}},props:{sortBy:{type:String,required:!0},sortOrder:{type:String,required:!0},cartItemCount:{type:Number,required:!0},getLessons:{type:Function,required:!0},searchLessons:{type:Function,required:!0},getImageUrl:{type:Function,required:!0},showCheckout:{type:Function,required:!0},canAddToCart:{type:Function,required:!0},isLoading:{type:Boolean,required:!0}},methods:{}},M=o(1241);const Z=(0,M.A)(G,[["render",D]]);var H=Z;const Y={class:"px-4 py-4 justify-content-center"},tt=(0,n.Fv)('<div class="d-flex justify-content-between align-items-center border-bottom mt-4 py-2"><div class="col-4">Subject</div><div class="col-2 justify-content-end ml-auto">Location:</div><div class="col-2">Price</div><div class="col-2">Quantity In Cart:</div><div class="col-2"></div></div>',1),et={class:"col-4 d-flex"},ot=["alt","src"],st={style:{"margin-left":"20px"}},nt={class:"col-2 justify-content-end ml-auto"},rt={class:"col-2"},it={class:"col-2"},at={class:"col-2 text-center"},lt=["onClick"],ct=(0,n.Lk)("h2",{style:{"font-size":"21px","margin-bottom":"15px"}},"Checkout",-1),dt=(0,n.Lk)("label",{for:"name"},[(0,n.Lk)("strong",null,"Name:")],-1),ut=(0,n.Lk)("label",{for:"phone"},[(0,n.Lk)("strong",null,"Phone:")],-1),pt=["disabled"],ht={class:"d-flex justify-content-center ml-auto mb-3 fixed-bottom"},mt=["disabled"],bt=(0,n.Lk)("span",{class:"fas fa-arrow-left"},null,-1);function vt(t,e,o,i,a,l){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",Y,[tt,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.cart,((e,s)=>((0,n.uX)(),(0,n.CE)("div",{style:{display:"inline-block"},key:s,class:"d-flex justify-content-between mt-4"},[(0,n.Lk)("div",et,[(0,n.Lk)("p",null,[(0,n.Lk)("img",{style:{height:"50px",width:"50px"},alt:e.topic,src:o.getImageUrl(e.image)},null,8,ot)]),(0,n.eW)(),(0,n.Lk)("p",st,(0,r.v_)(e.topic),1)]),(0,n.Lk)("div",nt,[(0,n.Lk)("p",null,(0,r.v_)(e.location),1)]),(0,n.Lk)("div",rt,[(0,n.Lk)("p",null,"$"+(0,r.v_)(e.price),1)]),(0,n.Lk)("div",it,[(0,n.Lk)("p",null,(0,r.v_)(e.cart_quantity),1)]),(0,n.Lk)("div",at,[(0,n.Lk)("button",{onClick:o=>t.$emit("remove-item-from-cart",e),class:"border border-none p-2 rounded-2 bg-info text-white",style:{"border-radius":"6px",cursor:"pointer","margin-left":"-40px"}}," Remove ",8,lt)])])))),128))]),(0,n.Lk)("form",{onSubmit:e[3]||(e[3]=(0,s.D$)((t=>o.submitOrder(a.order)),["prevent"])),class:"px-5 py-4 justify-content-center"},[(0,n.Lk)("div",null,[ct,(0,n.Lk)("p",null,[dt,(0,n.bo)((0,n.Lk)("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=t=>a.order.name=t),class:"input ml-2"},null,512),[[s.Jo,a.order.name,void 0,{trim:!0}]])]),(0,n.Lk)("p",null,[ut,(0,n.bo)((0,n.Lk)("input",{id:"phone","onUpdate:modelValue":e[1]||(e[1]=t=>a.order.phone=t),class:"input ml-2"},null,512),[[s.Jo,a.order.phone,void 0,{trim:!0}]])]),(0,n.Lk)("button",{disabled:!l.canCheckout,type:"submit",class:"btn btn-info p-3 rounded-2 text-white mt-4",style:{"border-radius":"6px"}}," Checkout ",8,pt)]),(0,n.Lk)("div",ht,[(0,n.Lk)("button",{disabled:o.isLoading,onClick:e[2]||(e[2]=(...t)=>o.showLessons&&o.showLessons(...t)),class:"border border-none p-3 rounded-2 bg-info text-white",style:{"border-radius":"6px",cursor:"pointer"}},[bt,(0,n.eW)(" "+(0,r.v_)(o.isLoading?"Please wait...":"Back To Lessons"),1)],8,mt)])],32)])}var ft={name:"checkout-component",data(){return{order:{name:"",phone:""}}},props:{cart:{type:Array,required:!0},submitOrder:{type:Function,required:!0},getImageUrl:{type:Function,required:!0},showLessons:{type:Function,required:!0},isLoading:{type:Boolean,required:!0}},computed:{canCheckout(){return!this.isLoading&&this.order.name.length>0&&this.order.phone.length>0&&/^[a-zA-Z\s]*$/.test(this.order.name)&&/^\d+$/.test(this.order.phone)}}};const yt=(0,M.A)(ft,[["render",vt]]);var kt=yt,gt={name:"App",components:{CheckoutComponent:kt,LessonsComponent:H},data(){let t="https://web-mobile-cw2.onrender.com";return{currentView:H,isLoading:!1,step:1,lessons:[],sort_by:"topic",sort_order:"asc",sitename:"Books Store",cart:[],base_url:t,image_base_url:`${t}/public`}},mounted(){this.fetchLessons()},methods:{fetchLessons(t=""){this.isLoading=!0;let e=t.length>0?"search?q="+t:"lessons";fetch(`${this.base_url}/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((t=>t.json())).then((t=>{this.lessons=t})).catch((t=>{console.log(t)})).finally((()=>this.isLoading=!1))},getImageUrl(t){return this.image_base_url+"/"+t},addToCart(t){let e=this.cart.find((({id:e})=>e===t.id));e?(e.cart_quantity+=1,e.spaces-=1):(t.spaces-=1,t.cart_quantity=1,this.cart.push(t))},showCheckout(){this.step=2},showLessons(){this.step=1},submitOrder(t){this.isLoading=!0;let e=this.cart.map((t=>({id:t._id,topic:t.topic,location:t.location,numberOfSpaces:t.cart_quantity})));fetch(`${this.base_url}/order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,lessonsInOrder:e})}).then((t=>t.json())).then((()=>{this.cart.forEach((t=>{this.reduceLessonQuantity(t._id,t.cart_quantity)})),alert("Order Submitted."),location.reload()})).catch((t=>{console.log(t)})).finally((()=>this.isLoading=!1))},reduceLessonQuantity(t,e){fetch(`${this.base_url}/lesson`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:t,reduceByQuantity:e})})},canAddToCart(t){return t.spaces>0},removeFromCart(t){this.cart.splice(this.cart.indexOf(t),1);let e=this.lessons.find((({id:e})=>e===t.id));e.spaces=5,e.cart_quantity=0,this.cartItemCount<1&&(this.step=1)},getLessons(){let t=[...this.lessons];return"topic"===this.sort_by&&t.sort(((t,e)=>t.topic>e.topic?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),"location"===this.sort_by&&t.sort(((t,e)=>t.location>e.location?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),"price"===this.sort_by&&t.sort(((t,e)=>t.price>e.price?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),"spaces"===this.sort_by&&t.sort(((t,e)=>t.spaces>e.spaces?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),t}},computed:{cartItemCount:function(){return this.cart.length}}};const Lt=(0,M.A)(gt,[["render",u]]);var Ct=Lt;(0,s.Ef)(Ct).mount("#app")}},e={};function o(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,o),r.exports}o.m=t,function(){var t=[];o.O=function(e,s,n,r){if(!s){var i=1/0;for(d=0;d<t.length;d++){s=t[d][0],n=t[d][1],r=t[d][2];for(var a=!0,l=0;l<s.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((function(t){return o.O[t](s[l])}))?s.splice(l--,1):(a=!1,r<i&&(i=r));if(a){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[s,n,r]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};o.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,r,i=s[0],a=s[1],l=s[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(l)var d=l(o)}for(e&&e(s);c<i.length;c++)r=i[c],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(d)},s=self["webpackChunkweb_mobile_cw3"]=self["webpackChunkweb_mobile_cw3"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=o.O(void 0,[504],(function(){return o(7304)}));s=o.O(s)})();
//# sourceMappingURL=app.685a0eac.js.map