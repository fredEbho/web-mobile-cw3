(function(){"use strict";var e={1634:function(e,t,o){var s=o(5130),n=o(6768),r=o(4232);const i=(0,n.Lk)("p",null,null,-1),a=["textContent"],l=(0,n.Lk)("p",null,null,-1),c={key:0,class:"step-one"},d={key:1};function u(e,t,o,s,u,p){const h=(0,n.g2)("LessonsComponent"),m=(0,n.g2)("CheckoutComponent");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("header",null,[i,(0,n.Lk)("div",{class:"text-center",style:{"font-size":"25px","margin-bottom":"50px"},textContent:(0,r.v_)(u.sitename)},null,8,a)]),(0,n.Lk)("main",null,[l,1===u.step?((0,n.uX)(),(0,n.CE)("div",c,[(0,n.bF)(h,{onAddToCart:p.addToCart,"can-add-to-cart":p.canAddToCart,"cart-item-count":p.cartItemCount,"show-checkout":p.showCheckout,"get-image-url":p.getImageUrl,"is-loading":u.isLoading,"get-lessons":p.getLessons,"search-lessons":p.fetchLessons,"sort-by":u.sort_by,"onUpdate:sortBy":t[0]||(t[0]=e=>u.sort_by=e),"sort-order":u.sort_order,"onUpdate:sortOrder":t[1]||(t[1]=e=>u.sort_order=e)},null,8,["onAddToCart","can-add-to-cart","cart-item-count","show-checkout","get-image-url","is-loading","get-lessons","search-lessons","sort-by","sort-order"])])):(0,n.Q3)("",!0),2===u.step?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(m,{onRemoveItemFromCart:p.removeFromCart,"get-image-url":p.getImageUrl,"is-loading":u.isLoading,cart:u.cart,"show-lessons":p.showLessons,"submit-order":p.submitOrder},null,8,["onRemoveItemFromCart","get-image-url","is-loading","cart","show-lessons","submit-order"])])):(0,n.Q3)("",!0)])],64)}o(4114);const p={class:"step-one"},h={class:"px-4 py-4 justify-content-center"},m={class:""},v={class:"d-flex justify-content-between my-2"},f={style:{"margin-top":"5px"},class:"me-5"},b=(0,n.Lk)("label",{for:"sort_by"},"Sort By:",-1),g=["value"],y=(0,n.Fv)('<option disabled value="">None</option><option value="topic">Subject</option><option value="location">Location</option><option value="price">Price</option><option value="spaces">Spaces</option>',5),k=[y],L={style:{"margin-top":"15px"}},C=(0,n.Lk)("label",{for:"sort_order"},"Sort Order:",-1),w=["value"],x=(0,n.Lk)("option",{disabled:"",value:""},"None",-1),_=(0,n.Lk)("option",{value:"asc"},"Ascending",-1),j=(0,n.Lk)("option",{value:"desc"},"Descending",-1),F=[x,_,j],O={style:{"margin-top":"20px"},class:"mb-4"},E=(0,n.Lk)("label",{for:"search"},"Search:",-1),I=(0,n.Fv)('<div class="d-flex justify-content-between align-items-center border-bottom mt-5 py-2"><div class="col-4">Subject</div><div class="col-2 justify-content-end ml-auto">Location</div><div class="col-2">Price</div><div class="col-2">Spaces</div><div class="col-2"></div></div>',1),q={key:0},S={class:"col-4 d-flex"},X=["alt","src"],$={style:{"margin-left":"20px"}},A={class:"col-2 justify-content-end ml-auto"},T={class:"col-2"},U={class:"col-2"},B={class:"mx-4"},K={class:"col-2 text-center"},N=["disabled","onClick"],P=(0,n.Lk)("span",{class:"fas fa-cart-plus"},null,-1),W={key:1,class:"d-flex mt-5 justify-content-center"},Q=(0,n.Lk)("div",{class:"lds-dual-ring justify-content-center align-items-center"},null,-1),J=[Q],R={class:"d-flex justify-content-center ml-auto mb-3 fixed-bottom"},V=["disabled"],z=(0,n.Lk)("span",{class:"fas fa-shopping-cart"},null,-1);function D(e,t,o,i,a,l){return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",h,[(0,n.Lk)("div",m,[(0,n.Lk)("div",v,[(0,n.Lk)("div",f,[b,(0,n.Lk)("select",{value:o.sortBy,onChange:t[0]||(t[0]=t=>e.$emit("update:sortBy",t.target.value)),id:"sort_by",class:"input ml-2"},k,40,g),(0,n.Lk)("div",L,[C,(0,n.Lk)("select",{value:o.sortOrder,onChange:t[1]||(t[1]=t=>e.$emit("update:sortOrder",t.target.value)),id:"sort_order",class:"input ml-2"},F,40,w)])]),(0,n.Lk)("div",O,[E,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.search=e),onInput:t[3]||(t[3]=e=>o.searchLessons(a.search)),id:"search",type:"search",name:"search",class:"input ml-2"},null,544),[[s.Jo,a.search]])])]),I,o.isLoading?((0,n.uX)(),(0,n.CE)("div",W,J)):((0,n.uX)(),(0,n.CE)("div",q,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.getLessons(),((t,s)=>((0,n.uX)(),(0,n.CE)("div",{style:{display:"inline-block",padding:"30px 0px 30px","border-bottom":"1px solid rgb(235, 227, 227)"},key:s,class:"d-flex justify-content-between"},[(0,n.Lk)("div",S,[(0,n.Lk)("p",null,[(0,n.Lk)("img",{style:{height:"50px",width:"50px"},alt:t.topic,src:o.getImageUrl(t.image)},null,8,X)]),(0,n.Lk)("p",$,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.topic.toString().split(new RegExp(`(?<=${a.search})|(?=${a.search})`,"i")),((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[e.toLowerCase()===a.search.toLowerCase()?((0,n.uX)(),(0,n.CE)("mark",{key:t,class:"text-warning"},(0,r.v_)(e),1)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,r.v_)(e),1)],64))],64)))),256))])]),(0,n.Lk)("div",A,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.location.toString().split(new RegExp(`(?<=${a.search})|(?=${a.search})`,"i")),((e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[e.toLowerCase()===a.search.toLowerCase()?((0,n.uX)(),(0,n.CE)("mark",{key:t,class:"text-warning"},(0,r.v_)(e),1)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,r.v_)(e),1)],64))],64)))),256))]),(0,n.Lk)("div",T,[(0,n.Lk)("p",null,"$"+(0,r.v_)(t.price),1)]),(0,n.Lk)("div",U,[(0,n.Lk)("p",B,(0,r.v_)(t.spaces),1)]),(0,n.Lk)("div",K,[(0,n.Lk)("button",{type:"button",disabled:!o.canAddToCart(t),onClick:o=>e.$emit("add-to-cart",t),class:"rounded-2 btn btn-info p-3 text-white",style:{"border-radius":"6px",cursor:"pointer"}},[P,(0,n.eW)(" Add to cart ")],8,N)])])))),128))]))]),(0,n.Lk)("div",R,[(0,n.Lk)("button",{type:"button",disabled:o.cartItemCount<1,onClick:t[4]||(t[4]=(...e)=>o.showCheckout&&o.showCheckout(...e)),class:"btn btn-info p-3 rounded-2 text-white",style:{"border-radius":"6px",cursor:"pointer"}},[(0,n.eW)((0,r.v_)(o.cartItemCount)+" ",1),z,(0,n.eW)(" View Cart ")],8,V)])])])}var G={name:"lessons-component",data(){return{search:""}},props:{sortBy:{type:String,required:!0},sortOrder:{type:String,required:!0},cartItemCount:{type:Number,required:!0},getLessons:{type:Function,required:!0},searchLessons:{type:Function,required:!0},getImageUrl:{type:Function,required:!0},showCheckout:{type:Function,required:!0},canAddToCart:{type:Function,required:!0},isLoading:{type:Boolean,required:!0}},methods:{}},M=o(1241);const Z=(0,M.A)(G,[["render",D]]);var H=Z;const Y={class:"px-4 py-4 justify-content-center"},ee=(0,n.Fv)('<div class="d-flex justify-content-between align-items-center border-bottom mt-4 py-2"><div class="col-4">Subject</div><div class="col-2 justify-content-end ml-auto">Location:</div><div class="col-2">Price</div><div class="col-2">Quantity In Cart:</div><div class="col-2"></div></div>',1),te={class:"col-4 d-flex"},oe=["alt","src"],se={style:{"margin-left":"20px"}},ne={class:"col-2 justify-content-end ml-auto"},re={class:"col-2"},ie={class:"col-2"},ae={class:"col-2 text-center"},le=["onClick"],ce=(0,n.Lk)("h2",{style:{"font-size":"21px","margin-bottom":"15px"}},"Checkout",-1),de=(0,n.Lk)("label",{for:"name"},[(0,n.Lk)("strong",null,"Name:")],-1),ue=(0,n.Lk)("label",{for:"phone"},[(0,n.Lk)("strong",null,"Phone:")],-1),pe=["disabled"],he={class:"d-flex justify-content-center ml-auto mb-3 fixed-bottom"},me=["disabled"],ve=(0,n.Lk)("span",{class:"fas fa-arrow-left"},null,-1);function fe(e,t,o,i,a,l){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",Y,[ee,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.cart,((t,s)=>((0,n.uX)(),(0,n.CE)("div",{style:{display:"inline-block"},key:s,class:"d-flex justify-content-between mt-4"},[(0,n.Lk)("div",te,[(0,n.Lk)("p",null,[(0,n.Lk)("img",{style:{height:"50px",width:"50px"},alt:t.topic,src:o.getImageUrl(t.image)},null,8,oe)]),(0,n.eW)(),(0,n.Lk)("p",se,(0,r.v_)(t.topic),1)]),(0,n.Lk)("div",ne,[(0,n.Lk)("p",null,(0,r.v_)(t.location),1)]),(0,n.Lk)("div",re,[(0,n.Lk)("p",null,"$"+(0,r.v_)(t.price),1)]),(0,n.Lk)("div",ie,[(0,n.Lk)("p",null,(0,r.v_)(t.cart_quantity),1)]),(0,n.Lk)("div",ae,[(0,n.Lk)("button",{onClick:o=>e.$emit("remove-item-from-cart",t),class:"border border-none p-2 rounded-2 bg-info text-white",style:{"border-radius":"6px",cursor:"pointer","margin-left":"-40px"}}," Remove ",8,le)])])))),128))]),(0,n.Lk)("form",{onSubmit:t[3]||(t[3]=(0,s.D$)((e=>o.submitOrder(a.order)),["prevent"])),class:"px-5 py-4 justify-content-center"},[(0,n.Lk)("div",null,[ce,(0,n.Lk)("p",null,[de,(0,n.bo)((0,n.Lk)("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>a.order.name=e),class:"input ml-2"},null,512),[[s.Jo,a.order.name,void 0,{trim:!0}]])]),(0,n.Lk)("p",null,[ue,(0,n.bo)((0,n.Lk)("input",{id:"phone","onUpdate:modelValue":t[1]||(t[1]=e=>a.order.phone=e),class:"input ml-2"},null,512),[[s.Jo,a.order.phone,void 0,{trim:!0}]])]),(0,n.Lk)("button",{disabled:!l.canCheckout,type:"submit",class:"btn btn-info p-3 rounded-2 text-white mt-4",style:{"border-radius":"6px"}}," Checkout ",8,pe)]),(0,n.Lk)("div",he,[(0,n.Lk)("button",{disabled:o.isLoading,onClick:t[2]||(t[2]=(...e)=>o.showLessons&&o.showLessons(...e)),class:"border border-none p-3 rounded-2 bg-info text-white",style:{"border-radius":"6px",cursor:"pointer"}},[ve,(0,n.eW)(" "+(0,r.v_)(o.isLoading?"Please wait...":"Back To Lessons"),1)],8,me)])],32)])}var be={name:"checkout-component",data(){return{order:{name:"",phone:""}}},props:{cart:{type:Array,required:!0},submitOrder:{type:Function,required:!0},getImageUrl:{type:Function,required:!0},showLessons:{type:Function,required:!0},isLoading:{type:Boolean,required:!0}},computed:{canCheckout(){return!this.isLoading&&this.order.name.length>0&&this.order.phone.length>0&&/^[a-zA-Z\s]*$/.test(this.order.name)&&/^\d+$/.test(this.order.phone)}}};const ge=(0,M.A)(be,[["render",fe]]);var ye=ge,ke={name:"App",components:{CheckoutComponent:ye,LessonsComponent:H},data(){let e="https://web-mobile-cw2.onrender.com";return{currentView:H,isLoading:!1,step:1,lessons:[],sort_by:"topic",sort_order:"asc",sitename:"Books Store",cart:[],base_url:e,image_base_url:`${e}/public`}},mounted(){this.fetchLessons()},methods:{fetchLessons(e=""){this.isLoading=!0;let t=e.length>0?"search?q="+e:"lessons";fetch(`${this.base_url}/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{this.lessons=e})).catch((e=>{console.log(e)})).finally((()=>this.isLoading=!1))},getImageUrl(e){return this.image_base_url+"/"+e},addToCart(e){let t=this.cart.find((({id:t})=>t===e.id));t?(t.cart_quantity+=1,t.spaces-=1):(e.spaces-=1,e.cart_quantity=1,this.cart.push(e))},showCheckout(){this.step=2},showLessons(){this.step=1},submitOrder(e){this.isLoading=!0;let t=this.cart.map((e=>({id:e._id,topic:e.topic,location:e.location,numberOfSpaces:e.cart_quantity})));fetch(`${this.base_url}/order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,lessonsInOrder:t})}).then((e=>e.json())).then((()=>{this.cart.forEach((e=>{this.reduceLessonQuantity(e._id,e.cart_quantity)})),alert("Order Submitted."),location.reload()})).catch((e=>{console.log(e)})).finally((()=>this.isLoading=!1))},reduceLessonQuantity(e,t){fetch(`${this.base_url}/lesson`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:e,reduceByQuantity:t})})},canAddToCart(e){return e.spaces>0},removeFromCart(e){this.cart.splice(this.cart.indexOf(e),1);let t=this.lessons.find((({id:t})=>t===e.id));t.spaces=5,t.cart_quantity=0,this.cartItemCount<1&&(this.step=1)},getLessons(){let e=[...this.lessons];return"topic"===this.sort_by&&e.sort(((e,t)=>e.topic>t.topic?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),"location"===this.sort_by&&e.sort(((e,t)=>e.location>t.location?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),"price"===this.sort_by&&e.sort(((e,t)=>e.price>t.price?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),"spaces"===this.sort_by&&e.sort(((e,t)=>e.spaces>t.spaces?"asc"===this.sort_order?1:-1:"asc"===this.sort_order?-1:1)),e}},computed:{cartItemCount:function(){return this.cart.length}}};const Le=(0,M.A)(ke,[["render",u]]);var Ce=Le,we=o(4458);(0,we.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),(0,s.Ef)(Ce).mount("#app")}},t={};function o(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,s,n,r){if(!s){var i=1/0;for(d=0;d<e.length;d++){s=e[d][0],n=e[d][1],r=e[d][2];for(var a=!0,l=0;l<s.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((function(e){return o.O[e](s[l])}))?s.splice(l--,1):(a=!1,r<i&&(i=r));if(a){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,n,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,r,i=s[0],a=s[1],l=s[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(l)var d=l(o)}for(t&&t(s);c<i.length;c++)r=i[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},s=self["webpackChunkweb_mobile_cw3"]=self["webpackChunkweb_mobile_cw3"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[504],(function(){return o(1634)}));s=o.O(s)})();
//# sourceMappingURL=app.72d468ce.js.map